<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Icon Finder</title>
    <style>
      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin-top: 2rem;
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
      }
      .flex-style {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
      }
      .search {
        width: 280px;
        height: 30px;
        font-size: 20px;
        padding: 5px;
      }
      .searchBtn {
        height: 30px;
      }
      .wrapper-img {
        width: 180px;
        height: 180px;
        border: 1px solid #eee;
        padding: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="flex-style" style="gap: 10px">
        <input type="search" class="search" placeholder="Search..." />
        <button class="searchBtn">Search</button>
      </div>
      <div
        class="flex-style imgs-container"
        style="gap: 1rem; margin-top: 2rem; max-width: 1000px"
      >
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
        <div class="wrapper-img">
          <img alt="image" loading="lazy" />
        </div>
      </div>
    </div>
  </body>
  <script>
    const searchInput = document.querySelector(".search");
    const searchBtn = document.querySelector(".searchBtn");
    const imgs = document.querySelectorAll(".imgs-container div img");
    let urlsArray = [];
    const corsUrl = "https://cors-anywhere.herokuapp.com/";

    // General Settings
    const apiKey =
      "YFBOmBBPCeZ1fVdk3rS9n13a6sXP3nATAMSb6govIV7vH4qbZ4GWu3t5k7jFIGCW";
    const options = {
      method: "GET",
      headers: {
        accept: "application/json",
        Authorization: `Bearer ${apiKey}`,
      },
    };

    // Search Button Action
    searchBtn.addEventListener("click", () => {
      fetchAllData();
    });

    // Reset Images
    imgs.forEach((item) => {
      item.src = "";
      item.style.display = "none";
    });

    // Get All Icons
    async function fetchAllData() {
      imgs.forEach((item) => {
        item.src = "";
        item.style.display = "none";
      });
      urlsArray = [];
      const targetUrl = `https://api.iconfinder.com/v4/icons/search?query=${searchInput.value}&count=10`;
      try {
        await fetch(targetUrl, options)
          .then((response) => response.json())
          .then((data) => {
            console.log(data.icons);
            data.icons.forEach((item) => {
              let resultData = item.raster_sizes[6].formats[0].preview_url;
              urlsArray.push(resultData);
              for (let i = 0; i < imgs.length; i++) {
                for (let j = i; j < urlsArray.length; j++) {
                  imgs[i].src = urlsArray[j];
                  imgs[i].style.display = "block";
                  break;
                }
              }
            });
          })
          .catch((err) => console.log("Fetch Error:", err.message));
      } catch (error) {
        console.log("Try Error:", error.message);
      }
    }

    // Click Image Action
    imgs.forEach((img) => {
      img.addEventListener("click", () => {
        console.log(img.src);
      });
    });
  </script>
</html>
